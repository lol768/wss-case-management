@import java.time.OffsetDateTime
@import java.util.UUID

@import controllers.RequestContext
@import domain.dao.CaseDao.Case
@import domain.{AppointmentRender, Enquiry, MessageData, SitsProfile, Team}
@import warwick.sso.{UniversityID, User, Usercode}

@(team: Team,
  enquiriesRequiringAction: Seq[(Enquiry, MessageData)],
  enquiriesAwaitingClient: Seq[(Enquiry, MessageData)],
  closedEnquiries: Int,
  openCases: Seq[(Case, OffsetDateTime)],
  closedCases: Int,
  declinedAppointments: Seq[AppointmentRender],
  provisionalAppointments: Seq[AppointmentRender],
  appointmentsNeedingOutcome: Seq[AppointmentRender],
  acceptedAppointments: Int,
  attendedAppointments: Int,
  cancelledAppointments: Int,
  clients: Map[UUID, Set[Either[UniversityID, SitsProfile]]],
  userLookup: Map[Usercode, User]
)(implicit request: RequestHeader, messagesProvider: MessagesProvider, context: RequestContext)

@main(s"${team.name} team") {
  <ul class="nav nav-tabs" role="tablist">
    <li role="presentation" class="active">
      <a href="#enquiries" aria-controls="enquiries" role="tab" data-toggle="tab">@tags.icons.enquiries() Enquiries</a>
    </li>
    <li role="presentation">
      <a href="#cases" aria-controls="cases" role="tab" data-toggle="tab">@tags.icons.cases() Cases</a>
    </li>
    <li role="presentation">
      <a href="#clients" aria-controls="clients" role="tab" data-toggle="tab">@tags.icons.clients() Clients</a>
    </li>
    <li role="presentation">
      <a href="#appointments" aria-controls="appointments" role="tab" data-toggle="tab">@tags.icons.appointments() Appointments</a>
    </li>
  </ul>

  <div class="tab-content">
    <div role="tabpanel" class="tab-pane active" id="enquiries">
      @views.html.admin.enquiriesTab(enquiriesRequiringAction, enquiriesAwaitingClient, closedEnquiries, clients, controllers.admin.routes.AdminController.closedEnquiries(team.id), "team", team.id, s" assigned to ${team.name}")
    </div>
    <div role="tabpanel" class="tab-pane" id="cases">
      @views.html.admin.casesTab(openCases, closedCases, clients, controllers.admin.routes.CaseController.createForm(team.id), controllers.admin.routes.AdminController.closedCases(team.id), "team", team.id, s" assigned to ${team.name}")
    </div>
    <div role="tabpanel" class="tab-pane" id="clients">
      @views.html.admin.clientsTab(controllers.admin.routes.AdminController.atRiskClients(team.id))
    </div>
    <div role="tabpanel" class="tab-pane" id="appointments">
      @views.html.admin.appointmentsTab(
        declinedAppointments,
        provisionalAppointments,
        appointmentsNeedingOutcome,
        acceptedAppointments,
        attendedAppointments,
        cancelledAppointments,
        clients,
        Some(userLookup),
        controllers.admin.routes.AppointmentController.createForm(team.id),
        controllers.admin.routes.AdminController.acceptedAppointments(team.id),
        controllers.admin.routes.AdminController.attendedAppointments(team.id),
        controllers.admin.routes.AdminController.cancelledAppointments(team.id),
        "team",
        team.id,
        s" assigned to ${team.name}"
      )
    </div>
  </div>
}
