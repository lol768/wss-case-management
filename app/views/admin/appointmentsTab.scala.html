@import java.util.UUID

@import domain.{AppointmentRender, SitsProfile}
@import warwick.sso.{UniversityID, User, Usercode}

@(
  declinedAppointments: Seq[AppointmentRender],
  provisionalAppointments: Seq[AppointmentRender],
  appointmentsNeedingOutcome: Seq[AppointmentRender],
  acceptedAppointments: Int,
  attendedAppointments: Int,
  cancelledAppointments: Int,
  clientLookup: Map[UUID, Set[Either[UniversityID, SitsProfile]]],
  userLookup: Option[Map[Usercode, User]],
  createRoute: Call,
  acceptedAppointmentsRoute: Call,
  attendedAppointmentsRoute: Call,
  cancelledAppointmentsRoute: Call,
  showStaffMember: Boolean = true,
)(implicit context: RequestContext, request: RequestHeader, messagesProvider: MessagesProvider)

@* TODO Search box *@

<p><a href="@createRoute" class="btn btn-default">Create a new appointment</a></p>

@views.html.admin.appointmentTable(Some("Appointments needing attention"), declinedAppointments, clientLookup, userLookup)
@views.html.admin.appointmentTable(Some("Appointment requests awaiting a response"), provisionalAppointments, clientLookup, userLookup)
@views.html.admin.appointmentTable(Some("Appointments needing outcome"), appointmentsNeedingOutcome, clientLookup, userLookup)

@if(acceptedAppointments > 0) {
  <details data-toggle="load" data-href="@acceptedAppointmentsRoute" data-target=".content">
    <summary>Show @tags.p(acceptedAppointments, "upcoming appointments")()</summary>
    <div class="content">
      <i class="fas fa-spinner fa-spin"></i> Loading&hellip;
    </div>
  </details>
}

@if(attendedAppointments > 0) {
  <details data-toggle="load" data-href="@attendedAppointmentsRoute" data-target=".content">
    <summary>Show @tags.p(attendedAppointments, "attended appointments")()</summary>
    <div class="content">
      <i class="fas fa-spinner fa-spin"></i> Loading&hellip;
    </div>
  </details>
}

@if(cancelledAppointments > 0) {
  <details data-toggle="load" data-href="@cancelledAppointmentsRoute" data-target=".content">
    <summary>Show @tags.p(cancelledAppointments, "cancelled appointments")()</summary>
    <div class="content">
      <i class="fas fa-spinner fa-spin"></i> Loading&hellip;
    </div>
  </details>
}